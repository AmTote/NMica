<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">

      <UsingTask TaskName="NMica.Tasks.PublishLayer" AssemblyFile="$(NMicaToolsPath)" />
      <UsingTask TaskName="NMica.Tasks.GenerateDockerfile" AssemblyFile="$(NMicaToolsPath)" />
      <UsingTask TaskName="NMica.Tasks.CleanPublishDir" AssemblyFile="$(NMicaToolsPath)" />
      <Target Name="PublishLayer" DependsOnTargets="Publish;CleanPublish">
          <PublishLayer TargetFrameworkMoniker="$(TargetFrameworkMoniker)" 
                    BaseIntermediateOutputPath="$(BaseIntermediateOutputPath)"
                    PublishDir="$(PublishDir)"
                    DockerLayer="$(DockerLayer)"
          />
      </Target>
      <Target Name="CleanPublish" BeforeTargets="Build" Condition="'$(NMicaLayer)'!=''">
          <CleanPublishDir PublishDir="$(PublishDir)" />
      </Target>
      <Target Name="GenerateNMicafile" AfterTargets="Build" Condition="'$(NMicaLayer)'==''">
          <GenerateDockerfile 
                  UsingMicrosoftNETSdkWeb="$(UsingMicrosoftNETSdkWeb)"
                  TargetFrameworkVersion="$(TargetFrameworkVersion)"
                  TargetFrameworkIdentifier="$(TargetFrameworkIdentifier)"
                  IsExecutable="$(_IsExecutable)"
                  SolutionPath="$(SolutionPath)"
                  MSBuildProjectName="$(MSBuildProjectName)"
                  MSBuildProjectFile="$(MSBuildProjectFile)"
                  AssemblyName="$(AssemblyName)"
          />
      </Target>
</Project>
